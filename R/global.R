



parameter_defaults <- list(
  GUTS_RED_SD = list(kd = 22, hb = 0.01, z = 0.5, kk = 0.08), # From howto
  GUTS_RED_IT = list(kd=1.2, hb=0, alpha=9.2, beta=4.3), # From Manual
  Lemna_Schmitt = list(Emax = 0.784, AperBM = 1000, Kbm = 0.75, P_Temp = FALSE, 
                       MolWeight = 381, k_phot_fix = FALSE, k_phot_max = 0.47, k_resp = 0.05, 
                       k_loss = 0, Tmin = 8, Tmax = 40.5, Topt = 26.7, t_ref = 25, 
                       Q10 = 2, k_0 = 3, a_k = 5e-05, C_P = 0.3, CP50 = 0.0043, 
                       a_P = 1, KiP = 101, C_N = 0.6, CN50 = 0.034, a_N = 1, KiN = 604, 
                       BM50 = 176, mass_per_frond = 1e-04, BMw2BMd = 16.7, EC50 = 0.3, 
                       b = 4.16, P_up = 0.0054), # from metsulfuron()@param
  # Lemna_SETAC = list(k_photo_fixed = 0, k_photo_max = 0.47, k_loss = 0.05,
  #                    BM_min = 5e-04, T_opt = 26.7, T_min = 8,
  #                    T_max = 40.5, Q10 = 2, T_ref = 25,
  #                    alpha = 5e-05, beta = 0.025, N_50 = 0.034,
  #                    P_50 = 0.0043, BM_L = 177, E_max = 1, 
  #                    r_A_DW = 1000, r_FW_DW = 16.7, r_FW_V = 1,
  #                    r_DW_FN = 1e-04, K_pw = 1, k_met = 0), # from Lemna_SETAC()@param
  Lemna_SETAC = list(k_photo_fixed = 0, k_photo_max = 0.47, k_loss = 0.05, BM_min = 0, 
                     T_opt = 26.7, T_min = 8, T_max = 40.5, Q10 = 2, T_ref = 25, 
                     alpha = 5e-05, beta = 0.025, N_50 = 0.034, P_50 = 0.0043, 
                     BM_L = 176, E_max = 0.784, r_A_DW = 1000, r_FW_DW = 16.7, 
                     r_FW_V = 1, r_DW_FN = 4e-04, K_pw = 0.75, k_met = 0, EC50_int = 0.3, 
                     b = 4.16, P = 0.0054),
  Myrio = list(k_photo_max = 0.47, E_max = 1, r_A_DW = 1000, r_FW_DW = 16.7, 
               r_FW_V = 1, K_pw = 1, k_met = 0), # from Myrio()@param
  DEB_abj = list(p_M = NA, v = NA, k_J = NA,
                 p_Am = NA, kap = NA, E_G = NA,
                 f = NA, E_Hj = NA, E_Hp = NA, 
                 kap_R = NA, ke = NA, c0 = NA,
                 cT = NA, L_b = NA, L_j = NA,
                 MoA = NA)
)

default_exposure <- data.frame(
  t=c(0,1,50,100,101,200,201,400),
  #pec=c(0,0,0.1,0.1,0,0))
  conc=c(0,0,0,0,1,0.1,0,0)
)



#model_choices <- c("GUTS_RED_SD", "GUTS_RED_IT", "Lemna_Schmitt", "Lemna_SETAC", "Myrio", "DEB_abj")
model_choices <- c("Lemna_Schmitt", "Lemna_SETAC")
#model_choices <- names(parameter_defaults)



# do.call(c, lapply(setNames(model_choices,model_choices), function(m){
#   f <- get(m)
#   x <- f()
#   length(list(param.req = x@forcings.req))>0
# }))

# 
# lapply(setNames(model_choices,model_choices), function(m){
#   f <- get(m)
#   x <- f()
#   list(param.req = x@param.req)
# })
# 
# 
# 
# 
# a <- numeric()
# a
# ex@param.req
# ?numeric
# 
# Lemna_Schmitt()@param.req
# dput(do.call(c, Lemna_Schmitt()@param))




forcing_defaults <- list(
  
  Lemna_Schmitt = list( # from metsulfuron
    temp = structure(list(t = 0, tmp = 12), class = "data.frame", row.names = c(NA, 
                                                                                -1L)), 
    rad = structure(list(t = 0, rad = 15000), class = "data.frame", row.names = c(NA, 
                                                                                  -1L))
  ),
  
  Lemna_SETAC = list( # from focusd1 dataset
    tmp = structure(list(Time = c(0, 1, 2, 3, 4, 5, 6, 7, 8, 
                                                   9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 
                                                   25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 
                                                   41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 
                                                   57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 
                                                   73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 
                                                   89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 
                                                   104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 
                                                   117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 
                                                   130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 
                                                   143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 
                                                   156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 
                                                   169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 
                                                   182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 
                                                   195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 
                                                   208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 
                                                   221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 
                                                   234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 
                                                   247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 
                                                   260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 
                                                   273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 
                                                   286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 
                                                   299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 
                                                   312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 
                                                   325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 
                                                   338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 
                                                   351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 
                                                   364, 365), 
                                          Temp = c(-1.7, -3.15, -5.9, -7.15, -13.15, -19.65, 
                                                   -14.5, -16.4, -15.8, -15.5, -8.25, -7.3, -12.2, -10.3, -2.5, 
                                                   -2, -7, -6.6, -10.2, -13.45, -10.5, -9.5, -7.95, -3.25, -2.25, 
                                                   -2.55, -1.4, -7.25, -9.9, -2.75, -2.6, -8.5, -13.4, -10.25, -4.9, 
                                                   -10.1, -10.7, -4.8, -3.05, -5.45, -1.75, 2, 2.25, 0.55, 0.9, 
                                                   -2.9, 0.2, -4.35, -1.1, -6, -7.85, -7.65, -8.05, -6.35, -6.05, 
                                                   -3.85, -1.75, -1.6, -4, -1.5, 0.4, 3.3, 0.85, 0.35, -0.15, -2.95, 
                                                   0.5, -2.85, -2.1, 0.1, 2, 1.95, 0.1, 2.3, 2.85, 4.1, 3.4, 2.2, 
                                                   0.6, 0.1, 0.9, 0.6, 2.55, 3.55, 5.6, 7.2, 5.35, 3.3, 2.25, 1.85, 
                                                   3.6, 2.2, 4.5, 3.15, 7.1, 2, 5.4, 4.2, 2.05, 1.75, 2.55, 3.2, 
                                                   1.3, 0.75, 0.9, 5.8, 6.7, 4.3, 5.8, 5.55, 4.25, 5.95, 5.75, 7.1, 
                                                   7.05, 5.9, 5.35, 5.6, 8.45, 5.3, 4.35, 5.75, 5, 3.55, 5, 6.3, 
                                                   7.25, 6.75, 9.7, 6.6, 6.8, 6.15, 7.65, 11.4, 10.1, 11.2, 12.95, 
                                                   12.65, 12.4, 7.85, 6.85, 8.15, 8.7, 7, 11.2, 10.9, 14.25, 14.75, 
                                                   13.3, 12.4, 14.3, 15.45, 12.85, 16.4, 18.2, 20, 20.3, 15.05, 
                                                   11.25, 15, 11.15, 7.85, 9.75, 9.55, 10.2, 6.95, 9.2, 9.1, 10.55, 
                                                   10.75, 10.8, 10.95, 9.7, 9.9, 11.35, 14.95, 13.4, 12.75, 12.6, 
                                                   14.3, 11.95, 10.2, 13.75, 14.15, 14.3, 15.95, 14.6, 13.55, 14.6, 
                                                   14.75, 16.15, 17.3, 17, 19.65, 20.25, 19.85, 19.9, 21.9, 17, 
                                                   15.5, 16.55, 18.1, 18.9, 15.35, 16.85, 18.3, 18.4, 16.4, 15.6, 
                                                   17.55, 19.45, 18.25, 19.8, 20.8, 20.7, 21, 19.2, 21.3, 21.15, 
                                                   19.95, 20.65, 20, 15.9, 15.35, 16.25, 16.2, 14.5, 13.6, 12.6, 
                                                   15.85, 15.05, 15.7, 12.3, 12.8, 12.3, 13.1, 13.85, 14.15, 14.1, 
                                                   14.6, 13.5, 11.9, 14.1, 14.45, 13.75, 12.15, 11.9, 12.15, 10.5, 
                                                   8.05, 9.7, 13.25, 13.4, 10.9, 14.05, 8.65, 11.7, 12.65, 14.85, 
                                                   12.45, 12.1, 15.05, 15.2, 14.35, 11.35, 11, 8.35, 6.95, 12.45, 
                                                   13, 14.45, 9.4, 10.7, 10.25, 12.35, 11.05, 10.7, 7.6, 10.15, 
                                                   11.6, 9.45, 8.9, 9.4, 6.4, 5.1, 3.95, 7.45, 7.35, 5.55, 5.85, 
                                                   2.95, 4.65, 4.3, 8, 8.5, 5.9, 9.15, 6.6, 2.75, 4.8, 6.15, 4.85, 
                                                   5.4, 6.05, 7.8, 5.05, 9.4, 7.55, 3.4, -1.8, -2.6, 0.3, -0.8, 
                                                   7.15, 8.95, 9.05, 8.7, 3.6, 3.85, 3, 2.2, 2.9, 0.65, 3.6, 2.75, 
                                                   0.55, 5.75, 6.45, 6.85, 4.55, 6.25, 2.95, 2.7, 0.45, -2, 1.85, 
                                                   0.6, 0.05, 0.8, 1.4, 2.7, -4.35, -4.25, 1.65, 2.75, -0.1, -2.6, 
                                                   -6.5, -6.35, -1.25, 0.25, -1.7, -2.8, 1.5, 1.3, 2.95, 0.05, -0.45, 
                                                   0.3, 1.55, 4.4, 0.95, -0.8, -2.05, -3.2, 2.1)), class = "data.frame", row.names = c(NA, 
                                                                                                                                       -366L)), 
                     irr = structure(list(Time = c(0, 1, 2, 3, 4, 5, 6, 7, 
                                                   8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 
                                                   24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 
                                                   40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 
                                                   56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 
                                                   72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 
                                                   88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 
                                                   103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 
                                                   116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 
                                                   129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 
                                                   142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 
                                                   155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 
                                                   168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 
                                                   181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 
                                                   194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 
                                                   207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 
                                                   220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 
                                                   233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 
                                                   246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 
                                                   259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 
                                                   272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 
                                                   285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 
                                                   298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 
                                                   311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 
                                                   324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 
                                                   337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 
                                                   350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 
                                                   363, 364, 365), 
                                          Rad = c(459.997056, 597.996, 778.99536, 761.995296, 
                                                  511.996896, 1230.99264, 1100.9952, 668.996064, 1108.99584, 1834.98912, 
                                                  1678.98528, 1044.99072, 1480.99104, 1577.99232, 1049.99328, 733.995648, 
                                                  991.99296, 1699.98912, 1817.9856, 1465.992, 872.99424, 766.995264, 
                                                  1109.98944, 1518.98976, 1199.99232, 1228.98816, 1042.99488, 1843.992, 
                                                  2914.98048, 1149.99264, 1163.98944, 2069.98848, 2561.98464, 3358.98144, 
                                                  2483.98272, 3766.97952, 2942.98272, 2901.97728, 1816.992, 1901.98368, 
                                                  2293.98912, 2039.9904, 2200.98816, 2316.9888, 2833.98048, 1812.99168, 
                                                  2032.98336, 3044.97792, 3842.97696, 4211.97408, 6040.9584, 6769.9584, 
                                                  4721.96736, 4940.96544, 5485.968, 5303.9664, 3188.9808, 2912.98464, 
                                                  3610.97568, 3901.97088, 4186.96992, 3461.97888, 3997.97856, 3077.98272, 
                                                  4780.96992, 8310.9456, 6252.95808, 9317.9808, 8641.9872, 6263.9568, 
                                                  5291.96544, 4513.968, 5855.95872, 4381.97472, 5363.96256, 5470.96896, 
                                                  6607.9584, 4727.97216, 5146.96896, 3456.97632, 5356.96416, 6352.95744, 
                                                  7769.952, 10007.9712, 9785.9232, 12526.9632, 11665.9008, 11901.9456, 
                                                  8878.9824, 10460.9664, 14721.8688, 13292.8992, 10698.912, 15383.8656, 
                                                  13896.9216, 13094.9568, 11010.9024, 11316.9312, 12716.9568, 11361.9456, 
                                                  12477.888, 11319.9552, 13713.9264, 14695.9488, 16162.9344, 13873.9392, 
                                                  15721.8624, 16108.9344, 16244.928, 15582.9312, 16162.9344, 14465.8656, 
                                                  18060.8832, 14871.9456, 14694.912, 21365.856, 16113.8592, 20700.8352, 
                                                  14899.9392, 14269.9104, 16973.8848, 13596.9408, 14985.9072, 14982.8832, 
                                                  15803.856, 16309.9008, 18392.9184, 22476.8736, 17430.8544, 16229.8944, 
                                                  15801.8688, 20729.8656, 22945.8528, 18752.8608, 22996.8288, 23014.8864, 
                                                  22097.8368, 23514.8832, 22527.8496, 14259.888, 12698.8992, 13965.8688, 
                                                  20452.8672, 16100.8992, 14748.912, 17904.8448, 18900.864, 23445.8496, 
                                                  18104.8608, 22003.8336, 24429.8592, 24099.8112, 21183.8976, 27866.8512, 
                                                  24548.832, 25208.8416, 27458.784, 17568.9216, 26105.8464, 21849.8688, 
                                                  19014.912, 24685.8624, 27477.792, 17718.912, 18762.8832, 17839.872, 
                                                  23764.8384, 26995.8528, 23528.88, 25414.8192, 26580.7872, 25632.8064, 
                                                  18521.9136, 22856.8608, 24590.8224, 20210.8608, 26057.808, 22864.896, 
                                                  12941.9424, 16459.8912, 14303.952, 13759.8912, 16473.888, 19370.88, 
                                                  16993.9296, 18993.9168, 22737.888, 22659.8688, 22915.872, 25827.8112, 
                                                  24769.8432, 24389.856, 23696.8416, 21990.8736, 23787.8208, 23353.8336, 
                                                  24700.8096, 18724.8672, 18898.8768, 24024.816, 23567.8464, 26070.8544, 
                                                  21459.8592, 21800.88, 26261.7984, 23818.8384, 22208.8608, 14741.9136, 
                                                  19209.9168, 23941.872, 22862.8224, 24953.8752, 25264.8288, 25278.8256, 
                                                  23753.8656, 24344.8416, 21100.8672, 24637.824, 21179.8368, 24542.8704, 
                                                  22879.8432, 15166.9152, 16649.8848, 17431.8912, 20238.8544, 13678.9344, 
                                                  12514.9536, 17512.848, 21186.8352, 14832.8928, 13843.872, 11734.9344, 
                                                  12271.9104, 12847.9392, 17129.9232, 13864.9536, 12193.8912, 12942.8928, 
                                                  12974.9472, 10018.944, 12924.9216, 14172.8832, 16260.912, 12301.8912, 
                                                  9640.944, 11666.9376, 10528.9632, 10874.9088, 12350.88, 10102.9248, 
                                                  9922.9536, 9415.9584, 9958.896, 14048.8992, 11401.9488, 13183.9488, 
                                                  11587.968, 9588.9312, 8417.94336, 9650.9664, 12506.9184, 8579.94336, 
                                                  8398.944, 8344.944, 8360.94528, 6960.95424, 9574.9344, 10524.9024, 
                                                  8612.94816, 6988.95648, 7051.95936, 9541.9296, 9232.9632, 6410.95776, 
                                                  5969.96352, 6927.95808, 6526.9584, 7272.95328, 6375.95712, 5779.96128, 
                                                  4043.97792, 2630.98368, 3296.9808, 4877.9712, 4254.97536, 5114.9664, 
                                                  3647.9808, 3535.98048, 2952.9792, 3590.97408, 4832.96544, 3232.97568, 
                                                  4206.97152, 4037.97312, 3549.97728, 4334.97312, 2234.98656, 2031.98976, 
                                                  4410.97056, 3391.9776, 4610.96928, 3747.98016, 2705.97888, 3505.97376, 
                                                  1259.98848, 1910.98656, 2065.98816, 2910.98016, 2637.98208, 2998.97856, 
                                                  3944.97216, 3414.97728, 2617.98048, 2858.98464, 1201.98816, 1333.99008, 
                                                  1313.98848, 1753.98912, 1359.98784, 1435.99392, 1661.9904, 1267.98912, 
                                                  983.99232, 1505.98656, 1115.99424, 1472.9904, 617.995872, 657.995616, 
                                                  1208.9952, 818.995104, 388.997856, 679.995648, 723.995712, 795.99456, 
                                                  1436.98752, 726.99552, 971.99136, 134.999136, 345.99744, 518.997024, 
                                                  512.996544, 711.995616, 1339.99488, 461.997216, 511.996896, 484.996896, 
                                                  682.995456, 831.994848, 1081.99584, 797.99472, 504.996768, 360.997344, 
                                                  846.994752, 470.99664, 380.997216, 174.99888, 616.996224, 502.996608, 
                                                  394.997472, 339.997824, 593.996544, 292.997952, 572.99616, 471.997152, 
                                                  976.99392, 621.996192)), class = "data.frame", row.names = c(NA, 
                                                                                                               -366L)), 
                     P = structure(list(time = 0, P = 0.3), class = "data.frame", row.names = c(NA, 
                                                                                                -1L)), 
                     N = structure(list(time = 0, N = 0.6), class = "data.frame", row.names = c(NA, 
                                                                                                -1L))
  )
)
